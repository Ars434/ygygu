 const models = [
            {
                name: '33 Stradale',
                year: '2023-н.в.',
                image: '../../img/AlfaRomeo33Stradale.jpg',
            },
            {
                name: 'Giulia',
                year: '2020-н.в.',
                image: '../../img/Gulia.jpg',
            },
            {
                name: 'Junior',
                year: '1966-н.в.',
                image: '../../img/AlfaRomeoJunior.jpg',
            },
            {
                name: 'Stelvio',
                year: '2017-н.в.',
                image: '../../img/AlfaRomeoStelvio.jpg',
            },
            {
                name: 'Tonale',
                year: '2022-н.в.',
                image: '../../img/AlfaRomeoTonale.jpg',
            },
            {
                name: 'Giulietta',
                year: '1954-2020',
                image: '../../img/AlfaRomeoGiulietta.webp',
            },
            {
                name: 'Disco Volante',
                year: '1952-2019',
                image: '../../img/AlfaRomeoDiscoVolante.jpg',
            },
            {
                name: 'MiTo',
                year: '2008-2018',
                image: '../../img/AlfaRomeoMiTo.jpg',
            },
            {
                name: '4C',
                year: '2013-2016',
                image: '../../img/AlfaRomeo4C.jpg',
            },
            {
                name: 'TZ',
                year: '1962-2014',
                image: '../../img/AlfaRomeoTZ.jpg',
            },
            {
                name: '159',
                year: '2005-2011',
                image: '../../img/AlfaRomeo159.jpg',
            },
            {
                name: '8C Competizione',
                year: '2003-2011',
                image: '../../img/AlfaRomeo8CCompetizione.webp',
            },
            {
                name: '147',
                year: '2000-2010',
                image: '../../img/AlfaRomeo147.jpeg',
            },
            {
                name: 'Brera',
                year: '2002-2010',
                image: '../../img/AlfaRomeoBrera.jpg',
            },
            {
                name: 'GT',
                year: '2003-2010',
                image: '../../img/AlfaRomeoGT.jpg',
            },
            {
                name: 'Spider',
                year: '1966-2010',
                image: '../../img/AlfaRomeoSpider.jpg',
            },
            {
                name: 'B.A.T.',
                year: '1953-2008',
                image: '../../img/AlfaRomeoBAT.jpg',
            },
            {
                name: '156',
                year: '1997-2007',
                image: '../../img/AlfaRomeo156.jpg',
            },
            {
                name: '166',
                year: '1998-2007',
                image: '../../img/AlfaRomeo166.jpg',
            },
            {
                name: 'Crosswagon Q4',
                year: '2004-2007',
                image: '../../img/AlfaRomeoCrosswagonQ4.jpg',
            },
            {
                name: 'GTV',
                year: '1974-2005',
                image: '../../img/AlfaRomeoGTV.jpg',
            },
            {
                name: '145',
                year: '1994-2000',
                image: '../../img/AlfaRomeo145.jpg',
            },
            {
                name: '146',
                year: '1995-2000',
                image: '../../img/AlfaRomeo146.webp',
            },
            {
                name: '155',
                year: '1992-1997',
                image: '../../img/AlfaRomeo155.jpg',
            },
            {
                name: '164',
                year: '1987-1997',
                image: '../../img/AlfaRomeo164.jpg',
            },
            {
                name: '33',
                year: '1983-1994',
                image: '../../img/AlfaRomeo33.webp',
            },
            {
                name: 'Sport Wagon',
                year: '1990-1994',
                image: '../../img/AlfaRomeoSportWagon.jpg',
            },
            {
                name: 'S.Z./R.Z.',
                year: '1989-1993',
                image: '../../img/AlfaRomeoSZRZ.jpg',
            },
            {
                name: '75',
                year: '1985-1992',
                image: '../../img/AlfaRomeo75.jpg',
            },
            {
                name: 'Milano',
                year: '1986-1989',
                image: '../../img/AlfaRomeoMilano.jpg',
            },
            {
                name: 'Sprint',
                year: '1963-1989',
                image: '../../img/AlfaRomeoSprint.jpg',
            },
            {
                name: '2300',
                year: '1974-1988',
                image: '../../img/AlfaRomeo2300.jpg',
            },
            {
                name: '90',
                year: '1984-1987',
                image: '../../img/AlfaRomeo90.jpg',
            },
            {
                name: 'Alfa 6',
                year: '1979-1987',
                image: '../../img/AlfaRomeoAlfa6.jpg',
            },
            {
                name: 'Arna',
                year: '1983-1987',
                image: '../../img/AlfaRomeoArna.jpg',
            },
            {
                name: 'Alfetta',
                year: '1972-1984',
                image: '../../img/AlfaRomeoAlfetta.jpg',
            },
            {
                name: '2000',
                year: '1958-1983',
                image: '../../img/AlfaRomeo2000.jpg',
            },
            {
                name: 'Alfasud',
                year: '1971-1983',
                image: '../../img/AlfaRomeoAlfasud.jpg',
            },
            {
                name: '179',
                year: '1979-1982',
                image: '../../img/AlfaRomeo179.jpg',
            },
            {
                name: '177',
                year: '1978-1979',
                image: '../../img/AlfaRomeo177.jpeg',
            },
            {
                name: 'Sport Sedan',
                year: '1978-1979',
                image: '../../img/AlfaRomeoSportSedan.jpg',
            },
            {
                name: 'Montreal',
                year: '1967-1977',
                image: '../../img/AlfaRomeoMontreal.jpg',
            },
            {
                name: '1750',
                year: '1967-1971',
                image: '../../img/AlfaRomeo1750.jpg',
            },
            {
                name: '2600',
                year: '1962-1969',
                image: '../../img/AlfaRomeo2600.jpeg',
            },
            {
                name: 'Tipo 33',
                year: '1967-1969',
                image: '../../img/AlfaRomeoTipo33.jpg',
            },
            {
                name: 'Gran Sport Quattroruote',
                year: '1965-1967',
                image: '../../img/AlfaRomeoGranSportQuattroruote.jpg',
            },
            {
                name: 'Scarabeo',
                year: '1966-1967',
                image: '../../img/AlfaRomeoScarabeo.jpg',
            },
            {
                name: 'Dauphine',
                year: '1959-1966',
                image: '../../img/AlfaRomeoDauphine.jpg',
            },
            {
                name: '6C',
                year: '1925-1960',
                image: '../../img/AlfaRomeo6C.jpg',
            },
            {
                name: '1900',
                year: '1950-1959',
                image: '../../img/AlfaRomeo1900.jpg',
            },
            {
                name: 'Abarth 1100 Monoposto Record',
                year: '1957',
                image: '../../img/AlfaRomeoAbarth1100MonopostoRecord.jpg',
            },
            {
                name: '1900 M',
                year: '1952-1954',
                image: '../../img/AlfaRomeo1900M.jpg',
            },
            {
                name: '2000 Sportiva',
                year: '1954',
                image: '../../img/AlfaRomeo2000Sportiva.jpg',
            },
            {
                name: 'Tipo 159 "Alfetta"',
                year: '1951',
                image: '../../img/AlfaRomeoTipo159.jpg',
            },
            {
                name: 'Tipo 412 Spider',
                year: '1951',
                image: '../../img/AlfaRomeoTipo412Spider.jpg',
            },
            {
                name: 'Tipo 158/47 "Alfetta"',
                year: '1938-1950',
                image: '../../img/AlfaRomeo15847Alfetta.jpg',
            },
            {
                name: 'Nardi-Danese Roadster',
                year: '1948',
                image: '../../img/AlfaRomeoNardiDaneseRoadster.jpg',
            },
            {
                name: 'Tipo 512 Gran Premio',
                year: '1940-1941',
                image: '../../img/AlfaRomeoTipo512GranPremio.jpg',
            },
            {
                name: '8C',
                year: '1931-1939',
                image: '../../img/AlfaRomeo8C.jpg',
            },
            {
                name: 'Tipo 316',
                year: '1938-1939',
                image: '../../img/AlfaRomeoTipo316.jpg',
            },
            {
                name: 'Tipo 308',
                year: '1938',
                image: '../../img/AlfaRomeoTipo308.jpg',
            },
            {
                name: '12C',
                year: '1936-1937',
                image: '../../img/AlfaRomeo12C.jpg',
            },
            {
                name: '16C Bimotore',
                year: '1935-1936',
                image: '../../img/AlfaRomeo16C.jpg',
            },
            {
                name: 'Tipo C',
                year: '1935-1936',
                image: '../../img/AlfaRomeoTipoC.jpg',
            },
            {
                name: 'Tipo B',
                year: '1932-1935',
                image: '../../img/AlfaRomeoTipoB.jpg',
            },
            {
                name: 'Tipo A Monoposto',
                year: '1931',
                image: '../../img/AlfaRomeoTipoAMonoposto.jpg',
            },
            {
                name: 'Tipo P2',
                year: '1924-1930',
                image: '../../img/AlfaRomeoTipoP2.jpg',
            },
            {
                name: 'RL',
                year: '1922-1927',
                image: '../../img/AlfaRomeoRL.jpg',
            },
            {
                name: 'RM',
                year: '1923-1926',
                image: '../../img/AlfaRomeoRM.jpg',
            },
            {
                name: '20-30',
                year: '1914-1922',
                image: '../../img/AlfaRomeo20-30.jpg',
            },
            {
                name: 'G1',
                year: '1921-1922',
                image: '../../img/AlfaRomeoG1.jpg',
            },
            {
                name: '40-60 HP',
                year: '1913-1915',
                image: '../../img/AlfaRomeo40-60HP.jpg',
            },
            {
                name: '24 HP',
                year: '1910-1914',
                image: '../../img/AlfaRomeo24HP.jpg',
            },
            {
                name: '15 HP',
                year: '1911-1913',
                image: '../../img/AlfaRomeo15HP.jpeg',
            },
        ];

        function createModelCard(model) {
            const card = document.createElement('div');
            card.className = 'model-card';
            card.innerHTML = `
                <img src="${model.image}" class="model-image" alt="${model.name}">
                <div class="model-info">
                    <h3 class="model-name">${model.name}</h3>
                    <p class="model-year">${model.year}</p>
                </div>
            `;

            card.addEventListener('click', () => {
                window.location.href = `model.html?name=${encodeURIComponent(model.name)}`;
            });

            return card;
        }

        function initPage() {
            const grid = document.querySelector('.container-grid');
            models.forEach(model => {
                grid.appendChild(createModelCard(model));
            });
        }

        window.addEventListener('scroll', () => {
            const scrolled = window.pageYOffset;
            document.querySelector('.header').style.transform =
                `translateY(${scrolled * 0.4}px)`;
        });














const manufacturers = [
    {
        name: 'Audi',
        logo: '../../img/brands/audilogo.png',
        popularModels: ['RS7', 'e-tron GT'],
    },
    {
        name: 'BMW',
        logo: '../../img/brands/bmwlogo.png',
        popularModels: ['M5 CS', 'M8', 'X5', 'i8'],
    },
    {
        name: 'Bugatti',
        logo: '../../img/brands/bugattilogo.png',
        popularModels: ['Veyron'],
    },
    {
        name: 'Cadillac',
        logo: '../../img/brands/cadillaclogo.png',
        popularModels: ['Escalade'],
    },
    {
        name: 'Dodge',
        logo: '../../img/brands/dodgelogo.png',
        popularModels: ['Charger'],
    },
    {
        name: 'Ferrari',
        logo: '../../img/brands/ferrarilogo.png',
        popularModels: ['SF90 Stradale'],
    },
    {
        name: 'Kia',
        logo: '../../img/brands/kialogo.png',
        popularModels: ['K5'],
    },
    {
        name: 'Lamborghini',
        logo: '../../img/brands/lamborghinilogo.png',
        popularModels: ['Temerario'],
    },
    {
        name: 'Mercedes-Benz',
        logo: '../../img/brands/merslogo.png',
        popularModels: ['GLE 63 AMG', 'CLS 63 AMG', 'V-Class', 'G-Wagon'],
    },
    {
        name: 'Porsche',
        logo: '../../img/brands/porschelogo.png',
        popularModels: ['911 Carrera 4 GTS'],
    },
    {
        name: 'Rolls-Royce',
        logo: '../../img/brands/rollsroycelogo.png',
        popularModels: ['Cullinan'],
    },
    {
        name: 'Skoda',
        logo: '../../img/brands/skodalogo.png',
        popularModels: ['Octavia'],
    },
    {
        name: 'Toyota',
        logo: '../../img/brands/toyotalogo.png',
        popularModels: ['Camry', 'Land Cruiser'],
    },
    {
        name: 'Volkswagen',
        logo: '../../img/brands/volkswagenlogo.png',
        popularModels: ['Golf'],
    },
];

// Обновленная функция initManufacturersMenu
function initManufacturersMenu() {
    const container = document.querySelector('.manufacturers-list');
    container.innerHTML = '';

    manufacturers.forEach(brand => {
        const item = document.createElement('div');
        item.className = 'manufacturer-item';
        item.innerHTML = `
            <img src="${brand.logo}" alt="${brand.name}">
            <span class="manufacturer-name">${brand.name}</span>
        `;

        item.querySelector('img').addEventListener('error', function() {
            this.src = 'img/fallback-logo.png';
        });

        item.addEventListener('click', (e) => {
            e.preventDefault();
            showBrandDetails(brand);
        });

        container.appendChild(item);
    });
}

function showBrandDetails(brand) {
    const megaMenu = document.querySelector('.mega-menu');
    const listContainer = document.querySelector('.manufacturers-list');
    const detailContainer = document.querySelector('.manufacturer-detail');
    const brandContent = document.querySelector('.brand-content');

    brandContent.innerHTML = `
        <div class="brand-header">
            <img src="${brand.logo}" alt="${brand.name}" class="brand-logo">
            <h2>${brand.name}</h2>
        </div>
            <button class="all-models-button">
                Все модели ${brand.name}
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <path d="M12 5L19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
        <div class="popular-models">
            <h3>Популярные модели</h3>
            <div class="models-grid">
                ${brand.popularModels.map(model => `
                    <div class="model-item" data-model="${model}">${model}</div>
                `).join('')}
            </div>
        </div>
    `;

    // Обработчики событий
    detailContainer.querySelectorAll('.model-item').forEach(item => {
        item.addEventListener('click', () => {
            const model = item.dataset.model;
            currentCars = cars.filter(car =>
                car.brand === brand.name && car.model === model
            );
            currentPage = 1;
            renderCars(currentCars, currentPage);
            updatePagination();
            megaMenu.classList.remove('visible');
        });
    });

// Обновленный обработчик для кнопки
// Функция для генерации SEO-friendly URL
const generateBrandSlug = (brandName) => {
    return brandName
        .toLowerCase()
        .replace(/\s+/g, '-')
        .replace(/[^a-z0-9-]/g, '');
};

// Обновленный обработчик кнопки "Все модели"
brandContent.querySelector('.all-models-button').addEventListener('click', () => {
    const slug = generateBrandSlug(brand.name);
    window.location.href = `../${slug}/index.html`;
});

    listContainer.style.display = 'none';
    detailContainer.style.display = 'block';
    megaMenu.style.height = '500px';
}

// Обработчик кнопки "Назад"
document.querySelector('.back-button').addEventListener('click', () => {
    const listContainer = document.querySelector('.manufacturers-list');
    const detailContainer = document.querySelector('.manufacturer-detail');

    listContainer.style.display = 'grid';
    detailContainer.style.display = 'none';
});

// Инициализация
window.addEventListener('DOMContentLoaded', () => {
    initManufacturersMenu();
    updateMenuPosition();
});

// Обновление позиции меню
function updateMenuPosition() {
    const navItem = document.querySelector('.with-mega-menu');
    if (!navItem) return;

    const navItemRect = navItem.getBoundingClientRect();
    const viewportHeight = window.innerHeight;
    const maxHeight = viewportHeight - navItemRect.bottom - 30;

    megaMenu.style.left = `${navItemRect.left}px`;
    megaMenu.style.top = `${navItemRect.bottom + 10}px`;
    megaMenu.style.maxHeight = `${Math.min(500, maxHeight)}px`;
}

// Обработчик скролла
window.addEventListener('scroll', () => {
    if (megaMenu.classList.contains('visible')) {
        updateMenuPosition();
    }
});



// Добавим делегирование событий для моделей
document.querySelector('.brand-content').addEventListener('click', (e) => {
    const modelItem = e.target.closest('.model-item');
    if (modelItem) {
        const brandName = document.querySelector('.brand-header h2').textContent;
        const model = modelItem.dataset.model;

        currentCars = cars.filter(car =>
            car.brand === brandName && car.model === model
        );
        currentPage = 1;
        renderCars(currentCars, currentPage);
        megaMenu.classList.remove('visible');
    }
});

// Добавим обработку ошибок изображений
const addImageFallback = (img) => {
    img.onerror = () => {
        img.src = 'img/fallback-logo.png';
        img.onerror = null;
    };
};

// Дебаунс для обработчика скролла
let isScrolling;
window.addEventListener('scroll', () => {
    if (megaMenu.classList.contains('visible')) {
        window.clearTimeout(isScrolling);
        isScrolling = setTimeout(() => {
            updateMenuPosition();
        }, 100);
    }
});

function preloadBrandLogos() {
    manufacturers.forEach(brand => {
        const img = new Image();
        img.src = brand.logo;
        img.decode().catch(() => {
            // Обработка ошибок
        });
    });
}

window.addEventListener('DOMContentLoaded', () => {
    preloadBrandLogos();
});

// Добавить в основной скрипт
// Добавить после initPage()
// Обновленная функция анимации временной шкалы
function animateTimeline() {
    const timelineItems = document.querySelectorAll('.timeline-item');

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if(entry.isIntersecting) {
                entry.target.classList.add('active');
            }
        });
    }, {
        threshold: 0.2,
        rootMargin: '-50px 0px' // Срабатывает на 50px раньше
    });

    timelineItems.forEach((item, index) => {
        // Добавляем задержку для последовательной анимации
        item.style.transitionDelay = `${index * 0.2}s`;
        observer.observe(item);
    });
}

document.addEventListener('DOMContentLoaded', () => {
    initPage();
    animateTimeline();
});
